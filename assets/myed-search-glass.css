/* ==========================================================================
  MyED — Search Template Glass (CANONICAL)
  Scope: ONLY body.myed-has-site-bg .template-search
  Goals:
  - Predictive dropdown never under product grid
  - Mobile facets drawer never white/empty (kills gradient fallback)
  - Consistent “glass pill” toolbar alignment
========================================================================== */

body.myed-has-site-bg .template-search{
  --myed-sg-bg: 10, 14, 22;
  --myed-sg-fg: 245, 247, 250;
  --myed-sg-border: rgba(255,255,255,0.14);
  --myed-sg-shadow: 0 18px 40px rgba(0,0,0,0.28);
  --myed-sg-radius: 22px;
  --myed-sg-pill-radius: 999px;

  position: relative;
  z-index: 0;
}

/* Header/search card */
body.myed-has-site-bg .template-search__header.page-width{
  position: relative;
  z-index: 20;

  background: rgba(var(--myed-sg-bg), 0.55);
  border: 1px solid var(--myed-sg-border);
  border-radius: var(--myed-sg-radius);
  -webkit-backdrop-filter: blur(14px);
  backdrop-filter: blur(14px);
  padding: 22px;
}

/* Search input */
body.myed-has-site-bg .template-search__search{
  position: relative;
  z-index: 30;
}

body.myed-has-site-bg .template-search__search .field{
  position: relative;

  background: rgba(var(--myed-sg-bg), 0.62);
  border: 1px solid rgba(255,255,255,0.16);
  border-radius: 14px;
  -webkit-backdrop-filter: blur(16px);
  backdrop-filter: blur(16px);
}

body.myed-has-site-bg .template-search__search .field__input{
  background: transparent;
  color: rgba(var(--myed-sg-fg), 0.92);
}

body.myed-has-site-bg .template-search__search .field__label{
  color: rgba(var(--myed-sg-fg), 0.65);
}

body.myed-has-site-bg .template-search__search :is(.reset__button, .search__button){
  color: rgba(var(--myed-sg-fg), 0.85);
}
body.myed-has-site-bg .template-search__search :is(.reset__button, .search__button) :is(svg, .icon){
  fill: currentColor;
  stroke: currentColor;
}

/* Product grid stays underneath overlays */
body.myed-has-site-bg .template-search :is(.product-grid-container, .template-search__results){
  position: relative;
  z-index: 1;
}

/* ==========================================================
   Predictive dropdown (search template)
   Dawn default z-index is 3 — we must win inside search template.
========================================================== */
body.myed-has-site-bg .template-search__search predictive-search{
  position: relative;
  z-index: 140;
}

body.myed-has-site-bg .template-search__search .predictive-search{
  position: absolute;
  left: 0;
  right: 0;
  top: calc(100% + 10px);
  z-index: 150;

  width: 100%;
  max-height: min(60vh, 48rem);
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;

  background: rgba(var(--myed-sg-bg), 0.97);
  border: 1px solid var(--myed-sg-border);
  border-radius: 14px;
  box-shadow: var(--myed-sg-shadow);
  -webkit-backdrop-filter: blur(14px);
  backdrop-filter: blur(14px);

  color: rgba(var(--myed-sg-fg), 0.92);
}

body.myed-has-site-bg .template-search .predictive-search :is(a,p,span,small,strong,li,div){
  color: rgba(var(--myed-sg-fg), 0.92);
}

/* ==========================================================
   Facets toolbar (glass pills)
========================================================== */
body.myed-has-site-bg .template-search :is(.facets-container, .facets, .facet-filters, .active-facets){
  position: relative;
  z-index: 15;
}

body.myed-has-site-bg .template-search :is(.facets__wrapper, .facet-filters, .active-facets){
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

/* Sort to the right when present */
body.myed-has-site-bg .template-search .facet-filters{
  margin-left: auto;
}

body.myed-has-site-bg .template-search :is(
  .mobile-facets__open,
  .facets__summary,
  .facet-filters__field .select__select,
  .mobile-facets__sort .select__select,
  .active-facets__button-inner
){
  min-height: 44px;
  border-radius: var(--myed-sg-pill-radius);
  background: rgba(var(--myed-sg-bg), 0.55);
  border: 1px solid rgba(255,255,255,0.16);
  box-shadow: var(--myed-sg-shadow);
  -webkit-backdrop-filter: blur(14px);
  backdrop-filter: blur(14px);
  color: rgba(var(--myed-sg-fg), 0.92);
}

body.myed-has-site-bg .template-search :is(.mobile-facets__open, .facets__summary){
  display: inline-flex;
  align-items: center;
  padding: 8px 14px;
}

body.myed-has-site-bg .template-search :is(.facet-filters__field .select__select, .mobile-facets__sort .select__select){
  padding-inline: 14px 38px;
}

/* Desktop disclosure panels (if used) */
body.myed-has-site-bg .template-search :is(.facets__disclosure, .facets__disclosure-vertical)[open]{
  position: relative;
  z-index: 70;
}

body.myed-has-site-bg .template-search :is(
  .facets__disclosure[open] .facets__display,
  .facets__disclosure-vertical[open] .facets__display-vertical
){
  background: rgba(var(--myed-sg-bg), 0.92);
  border: 1px solid var(--myed-sg-border);
  border-radius: 16px;
  box-shadow: var(--myed-sg-shadow);
  -webkit-backdrop-filter: blur(16px);
  backdrop-filter: blur(16px);
  color: rgba(var(--myed-sg-fg), 0.92);
}

/* ==========================================================
   Mobile facets drawer (fix “white/empty panel”)
   Dawn sets:
   - .mobile-facets__inner background-color: rgb(var(--color-background))
   - .mobile-facets__footer background: var(--gradient-background)
========================================================== */
body.myed-has-site-bg .template-search .mobile-facets__wrapper{
  position: relative;
  z-index: 220;
}

/* Overlay dim */
body.myed-has-site-bg .template-search .mobile-facets__wrapper .disclosure-has-popup[open] > summary::before{
  z-index: 219;
  background: rgba(0,0,0,0.58);
}

/* Force all drawer layers dark (NOT only inner) */
body.myed-has-site-bg .template-search :is(
  .mobile-facets__inner,
  .mobile-facets__main,
  .mobile-facets__submenu,
  .mobile-facets__footer
){
  background-color: rgba(var(--myed-sg-bg), 0.92) !important;
  background: rgba(var(--myed-sg-bg), 0.92) !important;
  background-image: none !important;
  color: rgba(var(--myed-sg-fg), 0.92);
}

body.myed-has-site-bg .template-search .mobile-facets__inner{
  border-left: 1px solid rgba(255,255,255,0.16);
  box-shadow: var(--myed-sg-shadow);
  -webkit-backdrop-filter: blur(18px);
  backdrop-filter: blur(18px);
}

body.myed-has-site-bg .template-search .mobile-facets__footer{
  border-top: 1px solid rgba(255,255,255,0.14);
}

body.myed-has-site-bg .template-search .mobile-facets__submenu{
  border-left: 1px solid rgba(255,255,255,0.14);
}

/* Prevent “white pills” inside labels */
body.myed-has-site-bg .template-search .mobile-facets__label > svg{
  background-color: transparent !important;
}

/* Highlight on selection */
body.myed-has-site-bg .template-search .mobile-facets__highlight{
  background-color: rgba(255,255,255,0.10);
}

/* Readability inside facets */
body.myed-has-site-bg .template-search :is(
  .facets__heading,
  .facets__label,
  .facets__reset,
  .active-facets__button-remove,
  .facet-filters__label,
  .mobile-facets__heading,
  .mobile-facets__summary,
  .mobile-facets__inner :is(a,button,label,span,p,h2,h3,input)
){
  color: rgba(var(--myed-sg-fg), 0.92);
}

/* Product card readability (search template only) */
body.myed-has-site-bg .template-search :is(.card__heading, .price, .price-item){
  color: rgba(var(--myed-sg-fg), 0.92);
}

@media (max-width: 989px){
  body.myed-has-site-bg .template-search__search .predictive-search{
    max-height: min(52vh, 40rem);
  }
}