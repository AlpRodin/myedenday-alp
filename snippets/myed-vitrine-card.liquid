{% liquid
  assign featured_image = product.featured_image
  assign image_alt = featured_image.alt | default: product.title

  assign compare_at_text = ''
  if product.compare_at_price and product.compare_at_price > product.price
    assign compare_at_text = product.compare_at_price | money
  endif

  assign description_text = product.description | strip_html | truncatewords: 24
  assign kicker_text = product.metafields.custom.kicker | default: product.vendor | default: 'Ausgewählt'

  assign image_loading = 'lazy'
  if index == 1
    assign image_loading = 'eager'
  endif
%}

<article class="myed-vt-card" data-myed-vt-card>
  <button
    type="button"
    class="myed-vt-card__btn"
    data-myed-vt-open
    data-vitrine-trigger
    aria-label="Produktdetails für {{ product.title | escape }} anzeigen"
    data-title="{{ product.title | escape }}"
    data-description="{{ description_text | escape }}"
    data-price="{{ product.price | money | escape }}"
    data-compare-at="{{ compare_at_text | escape }}"
    data-image="{% if featured_image %}{{ featured_image | image_url: width: 1200 }}{% endif %}"
    data-image-alt="{{ image_alt | escape }}"
    data-url="{{ product.url }}"
    data-kicker="{{ kicker_text | escape }}"
  >
    <span class="myed-vt-card__media" aria-hidden="true">
      {% if featured_image %}
        {{
          featured_image
          | image_url: width: 640
          | image_tag:
            loading: image_loading,
            widths: '200,280,360,480,640',
            sizes: '(min-width: 1200px) 14vw, (min-width: 990px) 18vw, (min-width: 750px) 24vw, 40vw',
            alt: image_alt,
            class: 'myed-vt-card__img'
        }}
      {% else %}
        <span class="myed-vt-card__placeholder"></span>
      {% endif %}
    </span>

    <span class="myed-vt-card__chip">
      <span class="myed-vt-card__name">{{ product.title | truncate: 18 }}</span>
      <span class="myed-vt-card__price">{{ product.price | money }}</span>
    </span>
  </button>
</article>
