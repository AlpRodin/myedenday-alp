{%- comment -%}
  MyED â€” Spotlight Card (OS 2.0)
  Usage: {% render 'myed-spotlight-card', product: p %}
{%- endcomment -%}

{%- if product != blank -%}
  {%- liquid
    assign card_img = product.featured_image
    if product.featured_media != blank
      assign card_img = product.featured_media.preview_image
    endif

    assign myed_alt = product.title | escape
    if card_img != blank and card_img.alt != blank
      assign myed_alt = card_img.alt | escape
    endif
  -%}

  <div class="myed-spotlight-card">
    <a class="myed-spotlight-card__media" href="{{ product.url }}" aria-label="{{ product.title | escape }}">
      {%- if card_img != blank -%}
        {{
          card_img
          | image_url: width: 900
          | image_tag:
            class: 'myed-spotlight-card__img',
            loading: 'lazy',
            widths: '240,360,480,720,900',
            sizes: '(min-width: 700px) 45vw, 90vw',
            alt: myed_alt
        }}
      {%- else -%}
        <div class="myed-spotlight-card__ph" aria-hidden="true"></div>
      {%- endif -%}
    </a>

    <div class="myed-spotlight-card__body">
      <a class="myed-spotlight-card__title" href="{{ product.url }}">{{ product.title }}</a>

      <div class="myed-spotlight-card__meta">
        <div class="myed-spotlight-card__price">
          {%- if product.compare_at_price_max > product.price -%}
            <span class="myed-spotlight-card__priceNow">{{ product.price | money }}</span>
            <span class="myed-spotlight-card__priceWas">{{ product.compare_at_price_max | money }}</span>
          {%- else -%}
            <span class="myed-spotlight-card__priceNow">{{ product.price | money }}</span>
          {%- endif -%}
        </div>

        {%- unless product.available -%}
          <span class="myed-spotlight-card__badge">Sold out</span>
        {%- endunless -%}
      </div>
    </div>
  </div>
{%- endif -%}
